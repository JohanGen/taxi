<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VIP Tour Transfers</title>
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="anonymous" />
  <style>
    /* --------- palette --------- */
    :root{
      --gold-1:#d4af37; /* light */
      --gold-2:#b8860b; /* deep */
      --card-bg:#1a1a1a;
      --page-bg:#0e0e0e;
      --text:#ffffff;
    }
    /* --------- global layout --------- */
    body{font-family:"Poppins",system-ui,sans-serif;background:var(--page-bg);display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;color:var(--text);}
    .card{background:var(--card-bg);padding:2rem;border-radius:1rem;box-shadow:0 10px 40px rgba(0,0,0,.7);width:100%;max-width:480px}
    h1{margin:0 0 1.25rem;text-align:center;font-size:2rem;font-weight:700}
    .gold{text-transform:uppercase;background:linear-gradient(90deg,var(--gold-1),var(--gold-2));-webkit-background-clip:text;background-clip:text;color:transparent;}
    label{font-weight:600;display:block;margin-bottom:.25rem}
    select,input{width:100%;padding:.55rem .8rem;border:1px solid #444;border-radius:.5rem;font-size:1rem;margin-bottom:1rem;background:#262626;color:var(--text);}
    select{appearance:none;background-image:url("data:image/svg+xml,%3Csvg fill='%23d4af37' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpath d='M5.516 7.548a.75.75 0 011.06 0L10 10.972l3.424-3.424a.75.75 0 111.06 1.06l-4 4a.75.75 0 01-1.06 0l-4-4a.75.75 0 010-1.06z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .7rem center;background-size:.8rem}
    #map{height:340px;border-radius:.5rem;margin-bottom:1rem}
    button{width:100%;padding:.8rem;border:none;border-radius:.5rem;font-size:1rem;font-weight:600;color:#000;background:linear-gradient(90deg,var(--gold-1),var(--gold-2));cursor:pointer;transition:opacity .2s}
    button:hover{opacity:.85}
    .hidden{display:none}
    .success{text-align:center;font-size:1.1rem;margin-bottom:1rem}
    .btn-group{display:flex;gap:.5rem}
    .btn-secondary,.btn-error{flex:1;border:none;border-radius:.5rem;padding:.6rem;font-weight:600;color:#000;background:var(--gold-1);cursor:pointer}
    .btn-error{background:#dc2626;color:#fff}
    /* spinner */
    .input-wrap{position:relative}
    .spinner{position:absolute;right:10px;top:50%;width:18px;height:18px;border:3px solid transparent;border-top:3px solid var(--gold-1);border-radius:50%;transform:translateY(-50%);animation:spin .8s linear infinite;display:none}
    @keyframes spin{0%{transform:translateY(-50%) rotate(0)}100%{transform:translateY(-50%) rotate(360deg)}}
  </style>
</head>
<body>
  <!-- ========= BOOKING CARD ========= -->
  <div class="card" id="form-card">
    <h1 class="gold" id="title">VIP Tour Travels</h1>

    <select id="lang">
      <option value="en">English</option>
      <option value="tr">Türkçe</option>
      <option value="ru">Русский</option>
      <option value="el">Ελληνικά</option>
    </select>

    <form id="booking-form" autocomplete="off">
      <label id="name-label" for="name">Name<span style="color:#e11d48">*</span></label>
      <input id="name" required />

      <label id="phone-label" for="phone">Phone Number<span style="color:#e11d48">*</span></label>
      <input id="phone" type="tel" pattern="\+\d[\d\s-]{6,}" placeholder="+90 533 123 4567" required />

      <!-- PICKUP -->
      <label id="pickup-label" for="pickup">Pickup Location<span style="color:#e11d48">*</span></label>
      <div class="input-wrap">
        <input id="pickup" list="pickup-list" required />
        <div class="spinner" id="spin-pick"></div>
      </div>
      <datalist id="pickup-list"></datalist>

      <!-- DESTINATION -->
      <label id="drop-label" for="drop">Destination<span style="color:#e11d48">*</span></label>
      <div class="input-wrap">
        <input id="drop" list="drop-list" required />
        <div class="spinner" id="spin-drop"></div>
      </div>
      <datalist id="drop-list"></datalist>

      <div id="map"></div>

      <label id="date-label" for="datetime">Date &amp; Time</label>
      <input id="datetime" type="datetime-local" />

      <button id="book-btn" type="submit">Book Now</button>
    </form>
  </div>

  <!-- ========= SUCCESS CARD ========= -->
  <div class="card hidden" id="success-card">
    <h1 class="gold" id="confirmed-title">Booking Confirmed</h1>
    <p class="success" id="summary"></p>
    <div class="btn-group">
      <button class="btn-secondary" id="edit-btn">Edit</button>
      <button class="btn-error" id="new-btn">New Booking</button>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin="anonymous"></script>

  <script>
    /* ---- translations (only titles updated for brevity) ---- */
    const translations={en:{title:'VIP Tour Travels',confirmedTitle:'Booking Confirmed',when:'When',from:'From',to:'To',fill:'Please fill in name and phone',select:'Please select pickup and destination',route:'Could not fetch route'}};
    let lang='en'; const $=id=>document.getElementById(id);

    /* ---- map ---- */
    const map=L.map('map').setView([35.2649,33.177],9);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19,attribution:'© OpenStreetMap'}).addTo(map);
    const shadow='https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png';
    const icons={pickup:new L.Icon({iconUrl:'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png',shadowUrl:shadow,iconSize:[25,41],iconAnchor:[12,41]}),drop:new L.Icon({iconUrl:'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png',shadowUrl:shadow,iconSize:[25,41],iconAnchor:[12,41]})};
    const state={pickup:null,drop:null,markers:{},route:null};

    /* ---- autocomplete ---- */
    const spinPick=$('spin-pick'),spinDrop=$('spin-drop');
    const pIn=$('pickup'),pList=$('pickup-list');
    const dIn=$('drop'),  dList=$('drop-list');
    async function search(q){if(!q.trim())return[];const url=`https://nominatim.openstreetmap.org/search?format=json&limit=5&q=${encodeURIComponent(q)}`;return fetch(url).then(r=>r.json())}
    function render(list,data){list.innerHTML=data.map(i=>`<option data-lat="${i.lat}" data-lon="${i.lon}" value="${i.display_name.replace(/"/g,'&quot;')}"></option>`).join('');}
    pIn.addEventListener('input',async e=>{spinPick.style.display='block';render(pList,await search(e.target.value));spinPick.style.display='none';});
    dIn.addEventListener('input',async e=>{spinDrop.style.display='block';render(dList,await search(e.target.value));spinDrop.style.display='none';});
    function choose(t,opt){const lat=+opt.dataset.lat,lon=+opt.dataset.lon,name=opt.value;if(state.markers[t])map.removeLayer(state.markers[t]);state.markers[t]=L.marker([lat,lon],{icon:icons[t]}).addTo(map);state[t]={name,coords:[lon,lat]};map.setView([lat,lon],13);if(state.pickup&&state.drop) route();}
    pIn.addEventListener('change',()=>{const opt=[...pList.options].find(o=>o.value===pIn.value);if(opt)choose('pickup',opt);});
    dIn.addEventListener('change',()=>{const opt=[...dList.options].find(o=>o.value===dIn.value);if(opt)choose('drop',opt);});

    async function route(){if(state.route){map.removeLayer(state.route);}const [lon1,lat1]=state.pickup.coords,[lon2,lat2]=state.drop.coords;const url=`https://router.project-osrm.org/route/v1/driving/${lon1},${lat1};${lon2},${lat2}?overview=full&geometries=geojson`;const data=await fetch(url).then(r=>r.json());if(data.code!=='Ok')return alert(translations[lang].route);const line=data.routes[0].geometry.coordinates.map(([x,y])=>[y,x]);state.route=L.polyline(line,{weight:4,opacity:.8}).addTo(map);map.fitBounds(state.route.getBounds(),{padding:[30,30]});}

    /* ---- form ---- */
    const form=$('booking-form'),formCard=$('form-card'),succ=$('success-card'),summary=$('summary');
    $('book-btn').textContent='Book Now';
    form.addEventListener('submit',e=>{e.preventDefault();const name=$('name').value.trim(),phone=$('phone').value.trim(),dt=$('datetime').value;const L=translations[lang];if(!name||!phone)return alert(L.fill);if(!state.pickup||!state.drop)return alert(L.select);summary.innerHTML=`<strong>${L.when}:</strong> ${dt||'ASAP'}<br><strong>${L.from}:</strong> ${state.pickup.name}<br><strong>${L.to}:</strong> ${state.drop.name}`;formCard.classList.add('hidden');succ.classList.remove('hidden');});
    $('edit-btn').onclick=()=>{succ.classList.add('hidden');formCard.classList.remove('hidden');};
    $('new-btn').onclick=()=>{form.reset();pList.innerHTML=dList.innerHTML='';Object.values(state.markers).forEach(m=>m&&map.removeLayer(m));if(state.route)map.removeLayer(state.route);Object.assign(state,{pickup:null,drop:null,markers:{},route:null});map.setView([35.2649,33.177],9);succ.classList.add('hidden');formCard.classList.remove('hidden');};
  </script>
</body>
</html>
